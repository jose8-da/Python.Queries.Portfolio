```python
# Import libraries

import pandas as pd
import numpy as np
import os
```


```python
# 3. Import data
df_ords_prods_combined = pd.read_pickle(r'/Users/jlsanabria77/Desktop/17-02.2021 Instacat Basket Analysis 3/02 Data/Prepared Data/orders_products_combined.pkl')
```


```python
# Turning folderpath into a string
path = r'/Users/jlsanabria77/Desktop/17-02.2021 Instacat Basket Analysis 3'
```


```python
# 4. Check the shape of the imported data
df_ords_prods_combined.shape
```




    (32434489, 10)




```python
# 4.1 Check it is the same as the exported data in the exercise
```

-From the exercise notebook. It has the same size

df_merged_large['_merge'].value_counts()
Out[16]:
both          32434489
right_only           0
left_only            0
Name: _merge, dtype: int64


```python
# 5. combine orders_products_combined with products dataset
```


```python
# 5.2 Import products dataset
df_prods_checked = pd.read_csv(r'/Users/jlsanabria77/Desktop/17-02.2021 Instacat Basket Analysis 3/02 Data/Prepared Data/products_checked.csv', index_col = False)
```


```python
# I will combine both datasets using a merge. Before I will check their shape to see how columns look
```


```python
df_prods_checked.head()
```


```python
df_ords_prods_combined.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>user_id</th>
      <th>eval_set</th>
      <th>order_number</th>
      <th>order_dow</th>
      <th>order_hour_of_day</th>
      <th>days_since_prior_order</th>
      <th>product_id</th>
      <th>add_to_cart_order</th>
      <th>reordered</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2539329</td>
      <td>1</td>
      <td>prior</td>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>NaN</td>
      <td>196</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2539329</td>
      <td>1</td>
      <td>prior</td>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>NaN</td>
      <td>14084</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2539329</td>
      <td>1</td>
      <td>prior</td>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>NaN</td>
      <td>12427</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2539329</td>
      <td>1</td>
      <td>prior</td>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>NaN</td>
      <td>26088</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2539329</td>
      <td>1</td>
      <td>prior</td>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>NaN</td>
      <td>26405</td>
      <td>5</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 5.3 By looking at both df I can see only product_id column can be used as a link to create a merge.
df_orders_products_merged = df_ords_prods_combined.merge(df_prods_checked, on = 'product_id', indicator = True)
```


```python
df_orders_products_merged.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>user_id</th>
      <th>eval_set</th>
      <th>order_number</th>
      <th>order_dow</th>
      <th>order_hour_of_day</th>
      <th>days_since_prior_order</th>
      <th>product_id</th>
      <th>add_to_cart_order</th>
      <th>reordered</th>
      <th>Unnamed: 0</th>
      <th>product_name</th>
      <th>aisle_id</th>
      <th>department_id</th>
      <th>prices</th>
      <th>_merge</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2539329</td>
      <td>1</td>
      <td>prior</td>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>NaN</td>
      <td>196</td>
      <td>1</td>
      <td>0</td>
      <td>195</td>
      <td>Soda</td>
      <td>77</td>
      <td>7</td>
      <td>9.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2398795</td>
      <td>1</td>
      <td>prior</td>
      <td>2</td>
      <td>3</td>
      <td>7</td>
      <td>15.0</td>
      <td>196</td>
      <td>1</td>
      <td>1</td>
      <td>195</td>
      <td>Soda</td>
      <td>77</td>
      <td>7</td>
      <td>9.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>2</th>
      <td>473747</td>
      <td>1</td>
      <td>prior</td>
      <td>3</td>
      <td>3</td>
      <td>12</td>
      <td>21.0</td>
      <td>196</td>
      <td>1</td>
      <td>1</td>
      <td>195</td>
      <td>Soda</td>
      <td>77</td>
      <td>7</td>
      <td>9.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2254736</td>
      <td>1</td>
      <td>prior</td>
      <td>4</td>
      <td>4</td>
      <td>7</td>
      <td>29.0</td>
      <td>196</td>
      <td>1</td>
      <td>1</td>
      <td>195</td>
      <td>Soda</td>
      <td>77</td>
      <td>7</td>
      <td>9.0</td>
      <td>both</td>
    </tr>
    <tr>
      <th>4</th>
      <td>431534</td>
      <td>1</td>
      <td>prior</td>
      <td>5</td>
      <td>4</td>
      <td>15</td>
      <td>28.0</td>
      <td>196</td>
      <td>1</td>
      <td>1</td>
      <td>195</td>
      <td>Soda</td>
      <td>77</td>
      <td>7</td>
      <td>9.0</td>
      <td>both</td>
    </tr>
  </tbody>
</table>
</div>




```python
# using the "merge flag" we can see that there is a full match of values
df_orders_products_merged['_merge'].value_counts()
```




    both          32404859
    right_only           0
    left_only            0
    Name: _merge, dtype: int64




```python
#  6. For the size of this merged dataframe I will choose pickle to export

df_orders_products_merged.to_pickle(os.path.join(path, '02 Data','Prepared Data', 'orders_products_merged.pkl'))
```


```python

```


```python

```

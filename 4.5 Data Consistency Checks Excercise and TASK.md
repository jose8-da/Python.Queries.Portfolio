```python
# Import libraries
import pandas as pd
import numpy as np
import os
```


```python
# Turning folderpath into a string
path = r'/Users/jlsanabria77/Desktop/17-02.2021 Instacat Basket Analysis 3'
```


```python
path
```




    '/Users/jlsanabria77/Desktop/17-02.2021 Instacat Basket Analysis 3'




```python
# Import "products_csv"
df_prods = pd.read_csv(os.path.join(path, '02 Data','Original Data','products.csv'), index_col = False)
```


```python
# Import "orders_csv"
df_ords = pd.read_csv(os.path.join(path, '02 Data','Original Data','orders.csv'), index_col = False)
```


```python
df_ords.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>user_id</th>
      <th>order_number</th>
      <th>order_dow</th>
      <th>order_hour_of_day</th>
      <th>days_since_prior_order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>3.421083e+06</td>
      <td>3.421083e+06</td>
      <td>3.421083e+06</td>
      <td>3.421083e+06</td>
      <td>3.421083e+06</td>
      <td>3.214874e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.710542e+06</td>
      <td>1.029782e+05</td>
      <td>1.715486e+01</td>
      <td>2.776219e+00</td>
      <td>1.345202e+01</td>
      <td>1.111484e+01</td>
    </tr>
    <tr>
      <th>std</th>
      <td>9.875817e+05</td>
      <td>5.953372e+04</td>
      <td>1.773316e+01</td>
      <td>2.046829e+00</td>
      <td>4.226088e+00</td>
      <td>9.206737e+00</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>8.552715e+05</td>
      <td>5.139400e+04</td>
      <td>5.000000e+00</td>
      <td>1.000000e+00</td>
      <td>1.000000e+01</td>
      <td>4.000000e+00</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.710542e+06</td>
      <td>1.026890e+05</td>
      <td>1.100000e+01</td>
      <td>3.000000e+00</td>
      <td>1.300000e+01</td>
      <td>7.000000e+00</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.565812e+06</td>
      <td>1.543850e+05</td>
      <td>2.300000e+01</td>
      <td>5.000000e+00</td>
      <td>1.600000e+01</td>
      <td>1.500000e+01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.421083e+06</td>
      <td>2.062090e+05</td>
      <td>1.000000e+02</td>
      <td>6.000000e+00</td>
      <td>2.300000e+01</td>
      <td>3.000000e+01</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Create a dataframe
df_test = pd.DataFrame()
```


```python
# Create a mixed type column
df_test['mix'] = ['a', 'b', 1, True]
```


```python
df_test.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mix</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Check for mixed types

for col in df_test.columns.tolist():
  weird = (df_test[[col]].applymap(type) != df_test[[col]].iloc[0].apply(type)).any(axis = 1)
  if len (df_test[weird]) > 0:
    print (col)
```

    mix



```python
df_test['mix'] = df_test['mix'].astype('str')
```


```python
df_prods.isnull().sum()
```




    product_id        0
    product_name     16
    aisle_id          0
    department_id     0
    prices            0
    dtype: int64




```python
df_nan=df_prods[df_prods['product_name'].isnull()== True]
```


```python
df_nan
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>product_id</th>
      <th>product_name</th>
      <th>aisle_id</th>
      <th>department_id</th>
      <th>prices</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>33</th>
      <td>34</td>
      <td>NaN</td>
      <td>121</td>
      <td>14</td>
      <td>12.2</td>
    </tr>
    <tr>
      <th>68</th>
      <td>69</td>
      <td>NaN</td>
      <td>26</td>
      <td>7</td>
      <td>11.8</td>
    </tr>
    <tr>
      <th>115</th>
      <td>116</td>
      <td>NaN</td>
      <td>93</td>
      <td>3</td>
      <td>10.8</td>
    </tr>
    <tr>
      <th>261</th>
      <td>262</td>
      <td>NaN</td>
      <td>110</td>
      <td>13</td>
      <td>12.1</td>
    </tr>
    <tr>
      <th>525</th>
      <td>525</td>
      <td>NaN</td>
      <td>109</td>
      <td>11</td>
      <td>1.2</td>
    </tr>
    <tr>
      <th>1511</th>
      <td>1511</td>
      <td>NaN</td>
      <td>84</td>
      <td>16</td>
      <td>14.3</td>
    </tr>
    <tr>
      <th>1780</th>
      <td>1780</td>
      <td>NaN</td>
      <td>126</td>
      <td>11</td>
      <td>12.3</td>
    </tr>
    <tr>
      <th>2240</th>
      <td>2240</td>
      <td>NaN</td>
      <td>52</td>
      <td>1</td>
      <td>14.2</td>
    </tr>
    <tr>
      <th>2586</th>
      <td>2586</td>
      <td>NaN</td>
      <td>104</td>
      <td>13</td>
      <td>12.4</td>
    </tr>
    <tr>
      <th>3159</th>
      <td>3159</td>
      <td>NaN</td>
      <td>126</td>
      <td>11</td>
      <td>13.1</td>
    </tr>
    <tr>
      <th>3230</th>
      <td>3230</td>
      <td>NaN</td>
      <td>120</td>
      <td>16</td>
      <td>14.4</td>
    </tr>
    <tr>
      <th>3736</th>
      <td>3736</td>
      <td>NaN</td>
      <td>41</td>
      <td>8</td>
      <td>14.8</td>
    </tr>
    <tr>
      <th>4283</th>
      <td>4283</td>
      <td>NaN</td>
      <td>77</td>
      <td>7</td>
      <td>14.4</td>
    </tr>
    <tr>
      <th>4790</th>
      <td>4790</td>
      <td>NaN</td>
      <td>91</td>
      <td>16</td>
      <td>14.5</td>
    </tr>
    <tr>
      <th>38187</th>
      <td>38183</td>
      <td>NaN</td>
      <td>39</td>
      <td>12</td>
      <td>20.9</td>
    </tr>
    <tr>
      <th>40444</th>
      <td>40440</td>
      <td>NaN</td>
      <td>120</td>
      <td>16</td>
      <td>14.8</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_prods.shape
```




    (49693, 5)




```python
df_prods_clean=df_prods[df_prods['product_name'].isnull()== False]
```


```python
df_prods_clean.shape
```




    (49677, 5)




```python
df_dups = df_prods_clean[df_prods_clean.duplicated()]
```


```python
df_dups
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>product_id</th>
      <th>product_name</th>
      <th>aisle_id</th>
      <th>department_id</th>
      <th>prices</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>462</th>
      <td>462</td>
      <td>Fiber 4g Gummy Dietary Supplement</td>
      <td>70</td>
      <td>11</td>
      <td>4.8</td>
    </tr>
    <tr>
      <th>18459</th>
      <td>18458</td>
      <td>Ranger IPA</td>
      <td>27</td>
      <td>5</td>
      <td>9.2</td>
    </tr>
    <tr>
      <th>26810</th>
      <td>26808</td>
      <td>Black House Coffee Roasty Stout Beer</td>
      <td>27</td>
      <td>5</td>
      <td>13.4</td>
    </tr>
    <tr>
      <th>35309</th>
      <td>35306</td>
      <td>Gluten Free Organic Peanut Butter &amp; Chocolate ...</td>
      <td>121</td>
      <td>14</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>35495</th>
      <td>35491</td>
      <td>Adore Forever Body Wash</td>
      <td>127</td>
      <td>11</td>
      <td>9.9</td>
    </tr>
  </tbody>
</table>
</div>




```python
df_prods_clean.shape
```




    (49677, 5)




```python
df_prods_clean_no_dups = df_prods_clean.drop_duplicates()
```


```python
df_prods_clean_no_dups.shape
```




    (49672, 5)




```python
df_prods_clean_no_dups.to_csv(os.path.join(path, '02 Data','Prepared Data', 'products_checked.csv'))
```

# 4.5 TASK


```python
# 1. consistency checks for df_prods already run in the exercise above
```


```python
# 2. Run df.describe() function on your df_prods dataframe
df_prods.describe()

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>product_id</th>
      <th>aisle_id</th>
      <th>department_id</th>
      <th>prices</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>49693.000000</td>
      <td>49693.000000</td>
      <td>49693.000000</td>
      <td>49693.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>24844.345139</td>
      <td>67.770249</td>
      <td>11.728433</td>
      <td>9.994136</td>
    </tr>
    <tr>
      <th>std</th>
      <td>14343.717401</td>
      <td>38.316774</td>
      <td>5.850282</td>
      <td>453.519686</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>12423.000000</td>
      <td>35.000000</td>
      <td>7.000000</td>
      <td>4.100000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>24845.000000</td>
      <td>69.000000</td>
      <td>13.000000</td>
      <td>7.100000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>37265.000000</td>
      <td>100.000000</td>
      <td>17.000000</td>
      <td>11.200000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>49688.000000</td>
      <td>134.000000</td>
      <td>21.000000</td>
      <td>99999.000000</td>
    </tr>
  </tbody>
</table>
</div>



Looking at the table we can see that all min values have
the same value 1, this is something we should look into. Aslo
when looking at the max values we can see an unusual price 9999.
We should also look into this value.


```python
# 3. Check for mix-typed data in df_ords
for col in df_ords.columns.tolist():
  weird = (df_ords[[col]].applymap(type) != df_ords[[col]].iloc[0].apply(type)).any(axis = 1)
  if len (df_ords[weird]) > 0:
    print (col)
```

NO mixed-typed data found in df_ords dataframe


```python
# 5. check missing values in df_ords
df_ords.isnull().sum()
```




    order_id                       0
    user_id                        0
    eval_set                       0
    order_number                   0
    order_dow                      0
    order_hour_of_day              0
    days_since_prior_order    206209
    dtype: int64



206209 missing values found in df_ords dataframe from days_since_prior_order column 


```python
# 6. Address missing values
df_nan1 = df_ords[df_ords['days_since_prior_order'].isnull() == True]
```


```python
df_nan1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>user_id</th>
      <th>eval_set</th>
      <th>order_number</th>
      <th>order_dow</th>
      <th>order_hour_of_day</th>
      <th>days_since_prior_order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2539329</td>
      <td>1</td>
      <td>prior</td>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2168274</td>
      <td>2</td>
      <td>prior</td>
      <td>1</td>
      <td>2</td>
      <td>11</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>26</th>
      <td>1374495</td>
      <td>3</td>
      <td>prior</td>
      <td>1</td>
      <td>1</td>
      <td>14</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>39</th>
      <td>3343014</td>
      <td>4</td>
      <td>prior</td>
      <td>1</td>
      <td>6</td>
      <td>11</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2717275</td>
      <td>5</td>
      <td>prior</td>
      <td>1</td>
      <td>3</td>
      <td>12</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3420930</th>
      <td>969311</td>
      <td>206205</td>
      <td>prior</td>
      <td>1</td>
      <td>4</td>
      <td>12</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3420934</th>
      <td>3189322</td>
      <td>206206</td>
      <td>prior</td>
      <td>1</td>
      <td>3</td>
      <td>18</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3421002</th>
      <td>2166133</td>
      <td>206207</td>
      <td>prior</td>
      <td>1</td>
      <td>6</td>
      <td>19</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3421019</th>
      <td>2227043</td>
      <td>206208</td>
      <td>prior</td>
      <td>1</td>
      <td>1</td>
      <td>15</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3421069</th>
      <td>3154581</td>
      <td>206209</td>
      <td>prior</td>
      <td>1</td>
      <td>3</td>
      <td>11</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>206209 rows × 7 columns</p>
</div>




```python
df_ords.shape
```




    (3421083, 7)



The total number of columns in this dataframe is 3421083, while the total number of missing values in the column days_since_prior_order is 206209. The fact that those values are missing indicates that there was only one order made and there there was no data related to when the prior order was made. So in this case I will choose to substitue those missing values with a zero.


```python
# imputing zero values to missing value cells
df_ords['days_since_prior_order'].fillna(0, inplace=True)
```


```python
df_ords
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>user_id</th>
      <th>eval_set</th>
      <th>order_number</th>
      <th>order_dow</th>
      <th>order_hour_of_day</th>
      <th>days_since_prior_order</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2539329</td>
      <td>1</td>
      <td>prior</td>
      <td>1</td>
      <td>2</td>
      <td>8</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2398795</td>
      <td>1</td>
      <td>prior</td>
      <td>2</td>
      <td>3</td>
      <td>7</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>473747</td>
      <td>1</td>
      <td>prior</td>
      <td>3</td>
      <td>3</td>
      <td>12</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2254736</td>
      <td>1</td>
      <td>prior</td>
      <td>4</td>
      <td>4</td>
      <td>7</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>431534</td>
      <td>1</td>
      <td>prior</td>
      <td>5</td>
      <td>4</td>
      <td>15</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3421078</th>
      <td>2266710</td>
      <td>206209</td>
      <td>prior</td>
      <td>10</td>
      <td>5</td>
      <td>18</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>3421079</th>
      <td>1854736</td>
      <td>206209</td>
      <td>prior</td>
      <td>11</td>
      <td>4</td>
      <td>10</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>3421080</th>
      <td>626363</td>
      <td>206209</td>
      <td>prior</td>
      <td>12</td>
      <td>1</td>
      <td>12</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>3421081</th>
      <td>2977660</td>
      <td>206209</td>
      <td>prior</td>
      <td>13</td>
      <td>1</td>
      <td>12</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>3421082</th>
      <td>272231</td>
      <td>206209</td>
      <td>train</td>
      <td>14</td>
      <td>6</td>
      <td>14</td>
      <td>30.0</td>
    </tr>
  </tbody>
</table>
<p>3421083 rows × 7 columns</p>
</div>




```python
# checkin if function worked
df_ords.isnull().sum()
```




    order_id                  0
    user_id                   0
    eval_set                  0
    order_number              0
    order_dow                 0
    order_hour_of_day         0
    days_since_prior_order    0
    dtype: int64



No missing values


```python
# 7. Check for duplicate values in df_ords
df_duplic = df_ords[df_ords.duplicated()]
```


```python
df_duplic
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>order_id</th>
      <th>user_id</th>
      <th>eval_set</th>
      <th>order_number</th>
      <th>order_dow</th>
      <th>order_hour_of_day</th>
      <th>days_since_prior_order</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



No duplicates found in df_ords dataframe


```python
# 9. Export final df_prods (already exported at the end of the exercise) and df_ords as "csv" files
df_ords_clean_no_dups.to_csv(os.path.join(path, '02 Data','Prepared Data', 'orders_checked.csv'))
```


```python

```
